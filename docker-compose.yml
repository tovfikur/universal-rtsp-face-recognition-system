services:
  smart-recognition-backend:
    build:
      context: .
      dockerfile: backend/Dockerfile
    container_name: smart-recognition-backend
    restart: unless-stopped
    runtime: ${DOCKER_RUNTIME:-runc}
    ports:
      - "5000:5000"
    environment:
      CAMERA_SOURCE: "${CAMERA_SOURCE:-0}"
      FACE_MODEL: "${FACE_MODEL:-hog}"
      FACE_TOLERANCE: "${FACE_TOLERANCE:-0.45}"
      YOLO_DEVICE: "${YOLO_DEVICE:-auto}"
      NVIDIA_VISIBLE_DEVICES: "${NVIDIA_VISIBLE_DEVICES:-all}"
      NVIDIA_DRIVER_CAPABILITIES: "${NVIDIA_DRIVER_CAPABILITIES:-compute,utility,video}"
    volumes:
      - ./backend/data:/app/backend/data
      - ./backend/faces:/app/backend/faces
      - ./frontend:/app/frontend:ro
